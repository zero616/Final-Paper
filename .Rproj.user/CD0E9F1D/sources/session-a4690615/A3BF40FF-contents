  #### Preamble ####
  # Purpose: Models... [...UPDATE THIS...]
  # Author: Rohan Alexander [...UPDATE THIS...]
  # Date: 11 February 2023 [...UPDATE THIS...]
  # Contact: rohan.alexander@utoronto.ca [...UPDATE THIS...]
  # License: MIT
  # Pre-requisites: [...UPDATE THIS...]
  # Any other information needed? [...UPDATE THIS...]
  
  
  #### Workspace setup ####
  library(tidyverse)
  library(rstanarm)
  
  #### Read data ####
  analysis_data <- read_csv("outputs/data/analysis_data.csv")
  
  ### Model data ####
  
  # Assuming df is your data frame with columns: Housing_Price, Consumption_Expenditure, and other relevant variables
  
  # Bayesian regression model using stan_glm
  bayesian_model <- stan_glm(Increasing_Rate_Cost ~ Increasing_Rate_NHPI,
                             data = analysis_data,
                             family = gaussian(),
                             prior = normal(location = 0, scale = 2.5),
                             prior_intercept = normal(location = 0, scale = 2.5),
                             prior_aux = exponential(rate = 1),
                             seed = 853)
  
  # Polynomial regression model
  model_poly <- lm(Increasing_Rate_Cost ~ poly(Increasing_Rate_NHPI, 2), data = analysis_data)
  
  # Summary of the polynomial model
  summary(model_poly)
  
  # Plot the data and the polynomial regression curve
  ggplot(analysis_data, aes(x = Increasing_Rate_NHPI, y = Increasing_Rate_Cost)) +
    geom_point() +
    geom_smooth(method = "lm", formula = y ~ poly(x, 5), se = FALSE) +
    labs(title = "Polynomial Regression: Increasing Rate YearCost vs. Increasing Rate House Price",
         x = "Increasing Rate House Price",
         y = "Increasing Rate YearCost")
  
  # Get the formula of the polynomial regression model
  formula(model_poly)
  #### Save model ####
  saveRDS(
    model_poly,
    file = "models/model.rds"
  )
  
  
  
